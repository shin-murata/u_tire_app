{% extends "base.html" %}

{% block content %}
<div class="container my-4">
    {# ğŸ”” ä¾¡æ ¼æœªå…¥åŠ›ã®ãƒ¢ãƒ¼ãƒ€ãƒ«é€šçŸ¥ï¼ˆè¡¨ç¤ºæ¡ä»¶ä»˜ãï¼‰ #}
    {% if price_alert %}
    <script>
      window.addEventListener('DOMContentLoaded', function() {
        var myModal = new bootstrap.Modal(document.getElementById('priceAlertModal'));
        myModal.show();
      });
    </script>

    <div class="modal fade" id="priceAlertModal" tabindex="-1" aria-labelledby="priceAlertModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="priceAlertModalLabel">ä¾¡æ ¼æœªå…¥åŠ›ã®ãŠçŸ¥ã‚‰ã›</h5>
          </div>
          <div class="modal-body">
            ä¸€éƒ¨ã®åœ¨åº«ã«ä¾¡æ ¼ãŒæœªç™»éŒ²ã§ã™ã€‚ä¾¡æ ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
    <!-- æ¤œç´¢æ¡ä»¶ãƒ•ã‚©ãƒ¼ãƒ  -->
    <form method="POST" class="mb-4">
        {{ form.hidden_tag() }}
        <div class="d-flex flex-wrap align-items-center gap-2">
            <div class="d-flex align-items-center nowrap">
                <label class="mr-2 mb-0">{{ form.registration_date.label }}</label>
                {{ form.registration_date(class="form-control", size=10) }}
            </div>
            <button type="submit" name="search" class="btn btn-primary">æ¤œç´¢</button>
            <button type="submit" name="filter_unpriced" class="btn btn-secondary">ä¾¡æ ¼æœªå…¥åŠ›</button>
            <button type="submit" name="filter_in_stock" class="btn btn-secondary">åœ¨åº«ãŒã‚ã‚‹ã‚‚ã®</button>
            <button type="submit" name="filter_dispatched" class="btn btn-secondary">å‡ºåº«æ¸ˆã¿</button>
            <button type="submit" name="reset" class="btn btn-secondary">å…¨ã¦è¡¨ç¤º</button>
        </div>
    </form>
    <!-- çµã‚Šè¾¼ã¿å¾Œã®ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º -->
    <!-- ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ãªãƒ†ãƒ¼ãƒ–ãƒ« -->
    <div class="table-responsive">
        <form method="POST">
            {{ form.hidden_tag() }}
            <table class="table table-bordered table-striped table-hover">
                <thead class="thead-light">
                    <tr>
                        <th style="min-width: 100px;">åœ¨åº«ç•ªå·</th>
                        <th style="min-width: 120px;">ç™»éŒ²æ—¥</th>
                        <th style="min-width: 80px;">å¹…</th>
                        <th style="min-width: 100px;">æ‰å¹³ç‡</th>
                        <th style="min-width: 80px;">ã‚¤ãƒ³ãƒ</th>
                        <th style="min-width: 80px;">ãƒ—ãƒ©ã‚¤</th>
                        <th style="min-width: 150px;">ãƒ¡ãƒ¼ã‚«ãƒ¼</th>
                        <th style="min-width: 100px;">è£½é€ å¹´</th>
                        <th style="min-width: 120px;">ä¾¡æ ¼</th>
                        <th style="min-width: 100px;">æ®‹ã‚Šæº</th>
                        <th style="min-width: 100px;">ç‰‡æ¸›ã‚Š</th>
                        <th style="min-width: 100px;">åœ¨åº«</th>
                        <th style="min-width: 150px;">ãã®ä»–</th>
                        <th style="min-width: 150px;">æœ€çµ‚æ›´æ–°è€…</th>
                        <th style="min-width: 200px;">æœ€çµ‚æ›´æ–°æ—¥æ™‚</th>
                    </tr>
                </thead>
                <tbody>
                    {% for tire in tires %}
                    <tr>
                        <td>{{ tire.id }}</td>
                        <td>
                            {{ tire.registration_date|datetime_jp if tire.registration_date else 'N/A' }}
                        </td>                                         
                        <td>{{ tire.width_ref.value }}</td>
                        <td>{{ tire.aspect_ratio_ref.value }}</td>
                        <td>{{ tire.inch_ref.value }}</td>
                        <td>{{ tire.ply_rating_ref.value }}</td>
                        <td>{{ tire.manufacturer_ref.name }}</td>
                        <td>{{ tire.manufacturing_year }}</td>
                        <td>
                            <input type="text" name="price_{{ tire.id }}" value="{{ tire.price|int|currency }}" class="form-control" size="10">
                        </td>
                        <td>{{ tire.tread_depth }}</td>
                        <td>{{ tire.uneven_wear }}</td>
                        <td>
                            {% if tire.is_dispatched %}
                                ãªã—
                            {% else %}
                                ã‚ã‚Š
                            {% endif %}
                        </td>
                        <td>
                            <input type="text" name="other_details_{{ tire.id }}" value="{{ tire.other_details }}" class="form-control" size="20">
                        </td>
                        <td>{{ tire.last_edited_name }}</td>
                        <td>
                            {{ tire.last_edited_at|datetime_jp if tire.last_edited_at else 'N/A' }}
                        </td>
                        <td><a href="{{ url_for('edit_page', id=tire.id) }}" class="btn btn-warning">ç·¨é›†</a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <button type="submit" name="update_all" class="btn btn-primary">ä¸€æ‹¬æ›´æ–°</button>
        </form>
    </div>
</div>

{% endblock %}